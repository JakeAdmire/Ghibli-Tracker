(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{32:function(e,t,a){e.exports=a.p+"static/media/favorite.ff2179cb.svg"},33:function(e,t,a){e.exports=a(50)},38:function(e,t,a){},50:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(29),s=a.n(i),c=(a(38),a(1)),o=a.n(c),l=a(3),u=a(12),p=a(13),d=a(16),m=a(14),h=a(17),v=a(8),f="06195bd3d9278a83a0a3d0852d9b2d1b",g=a(10),b=a(11),E=function(){var e=Object(l.a)(o.a.mark(function e(t){var a,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:return a=e.sent,e.next=6,a.json();case 6:return n=e.sent,e.abrupt("return",n);case 10:throw e.prev=10,e.t0=e.catch(0),new Error("Response not okay");case 13:case"end":return e.stop()}},e,null,[[0,10]])}));return function(t){return e.apply(this,arguments)}}(),w=a(22),O=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(w.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault();var t=e.target.value,n=a.state;n.email=n.email.toLowerCase(),"Log In"===t&&a.validateUser("/api/users",n),"Sign Up"===t&&a.createUser("/api/users/new",n)},a.state={name:"",email:"",password:"",loggedIn:!1,errorMessage:"",toggleSignUp:!1},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"validateUser",value:function(){var e=Object(l.a)(o.a.mark(function e(){var t,a,n,r=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"",a=r.length>1&&void 0!==r[1]?r[1]:{},e.prev=2,e.next=5,this.fetchUser(t,a);case 5:n=e.sent,this.props.loginUser(n.data.id,n.data.name),this.setState({loggedIn:!0}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),this.setState({errorMessage:"Sorry, you entered an incorrect email or password"});case 13:case"end":return e.stop()}},e,this,[[2,10]])}));return function(){return e.apply(this,arguments)}}()},{key:"createUser",value:function(){var e=Object(l.a)(o.a.mark(function e(){var t,a,n,r=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"",a=r.length>1&&void 0!==r[1]?r[1]:{},e.prev=2,e.next=5,this.fetchUser(t,a);case 5:n=e.sent,this.props.loginUser(n.id,a.name),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(2),new Error("user already exists");case 12:case"end":return e.stop()}},e,this,[[2,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"fetchUser",value:function(){var e=Object(l.a)(o.a.mark(function e(t,a){var n,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:3000".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(0),new Error("Request unsuccessful");case 13:case"end":return e.stop()}},e,null,[[0,10]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"Account"},this.state.toggleSignUp?r.a.createElement("form",null,r.a.createElement("div",null,r.a.createElement("button",{className:"disabled"},"Sign In"),r.a.createElement("button",{onClick:function(){return e.setState({toggleSignUp:!1})}},"Create Account")),r.a.createElement("label",{htmlFor:"email"},"Email:"),r.a.createElement("input",{placeholder:"ex. kim@mail.com..",type:"text",name:"email",value:this.state.email,onChange:this.handleChange,required:!0}),r.a.createElement("label",{htmlFor:"password"},"Password:"),r.a.createElement("input",{placeholder:"ex. floomples..",type:"text",name:"password",value:this.state.password,onChange:this.handleChange,required:!0}),r.a.createElement("button",{className:"submit",value:"Log In",onClick:this.handleSubmit},"LOG IN")):r.a.createElement("form",null,r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.setState({toggleSignUp:!0})}},"Sign In"),r.a.createElement("button",{className:"disabled"},"Create Account")),r.a.createElement("label",{htmlFor:"name"},"Name:"),r.a.createElement("input",{placeholder:"Kim..",type:"text",name:"name",value:this.state.name,onChange:this.handleChange,required:!0}),r.a.createElement("label",{htmlFor:"email"},"Email:"),r.a.createElement("input",{placeholder:"ex. kim@mail.com..",type:"text",name:"email",value:this.state.email,onChange:this.handleChange,required:!0}),r.a.createElement("label",{htmlFor:"password"},"Password:"),r.a.createElement("input",{placeholder:"ex. floomples..",type:"text",name:"password",value:this.state.password,onChange:this.handleChange,required:!0}),r.a.createElement("button",{className:"submit",value:"Sign Up",onClick:this.handleSubmit},"SIGN UP")),this.state.loggedIn&&r.a.createElement(b.a,{to:"/ghibli-tracker"}),this.state.errorMessage?r.a.createElement("div",null,this.state.errorMessage):r.a.createElement("div",null,"Please sign in or create an account"))}}]),t}(n.Component),x=Object(v.b)(null,function(e){return{loginUser:function(t,a){return e(function(e,t){return{type:"LOGIN_USER",id:e,name:t}}(t,a))}}})(O),k=a(32),S=a.n(k),y=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).toggleFavorite=Object(l.a)(o.a.mark(function e(){var t,n,r,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props,n=t.user,r=t.id,i=!1,!n.name){e.next=11;break}return e.next=5,E("http://localhost:3000/api/users/".concat(n.id,"/favorites"));case 5:e.sent.data.forEach(function(e){e.movie_id===r&&(i=!0)}),a["".concat(i?"delete":"add","Favorite")](),e.next=12;break;case 11:a.setState({redirect:!0});case 12:case"end":return e.stop()}},e)})),a.addFavorite=Object(l.a)(o.a.mark(function e(){var t,n,r,i,s,c,l,u;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props,n=t.id,r=t.title,i=t.poster_path,s=t.release_date,c=t.vote_average,l=t.overview,u=t.user,e.next=3,fetch("http://localhost:3000/api/users/favorites/new",{method:"POST",body:JSON.stringify({user_id:u.id,movie_id:n,title:r,poster_path:i,release_date:s,vote_average:c,overview:l}),headers:{"Content-Type":"application/json"}});case 3:case"end":return e.stop()}},e)})),a.deleteFavorite=Object(l.a)(o.a.mark(function e(){var t,n,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props,n=t.id,r=t.user,e.next=3,fetch("http://localhost:3000/api/users/".concat(r.id,"/favorites/").concat(n),{method:"DELETE",body:JSON.stringify({movie_id:n,user_id:r.id}),headers:{"Content-Type":"application/json"}});case 3:case"end":return e.stop()}},e)})),a.determineFavorite=Object(l.a)(o.a.mark(function e(){var t,n,r,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props,n=t.id,!(r=t.user).name){e.next=6;break}return e.next=4,E("http://localhost:3000/api/users/".concat(r.id,"/favorites"));case 4:return i=e.sent,e.abrupt("return",i.data.forEach(function(e){if(e.movie_id===n)return!0}));case 6:case"end":return e.stop()}},e)})),a.state={redirect:!1},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"buildDescription",value:function(){return this.props.overview.split("").slice(0,40).join("")+"..."}},{key:"render",value:function(){var e=this.props,t=e.poster_path,a=e.title,n=e.id,i=e.vote_average,s=e.original_title,c=this.determineFavorite()?"fave active":"fave",o=this.buildDescription(),l={backgroundImage:"url(https://image.tmdb.org/t/p/w500".concat(t,")"),backgroundSize:"cover"};return r.a.createElement("div",{className:"Card",style:l},r.a.createElement("div",{className:"screen"}),r.a.createElement(g.b,{to:"/movies/".concat(n)},r.a.createElement("h3",{className:"title"},a),r.a.createElement("p",{className:"language"},s),r.a.createElement("p",{className:"overview"},o)),r.a.createElement("p",{className:"vote"},r.a.createElement("span",null,i),"/10"),r.a.createElement("object",{data:S.a,type:"image/svg+xml",className:c,onClick:this.toggleFavorite},"Image not found"),this.state.redirect&&r.a.createElement(b.a,{to:"/login"}))}}]),t}(n.Component),j=Object(v.b)(function(e){return{user:e.user}},null)(y);var _=Object(v.b)(function(e){return{films:e.films}},null)(function(e){var t=e.films.map(function(e){return r.a.createElement(j,Object.assign({key:e.id},e))});return r.a.createElement("div",{className:"CardContainer"},t)});function C(){return r.a.createElement("div",{className:"Header"},r.a.createElement("h1",null,"GhibliTracker"))}function N(e){return console.log(e),r.a.createElement("div",null,r.a.createElement("h1",null,e.title),r.a.createElement("p",null,e.vote_average,"/10"),r.a.createElement("h2",null,e.original_title),r.a.createElement("p",null,e.release_date),r.a.createElement("p",null,e.overview))}function F(){return r.a.createElement("h2",null,"Loading...")}var U=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).buildCards=Object(l.a)(o.a.mark(function e(){var t,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading:!0}),t="https://api.themoviedb.org/3/discover/movie?api_key=".concat(f,"&language=en-US&sort_by=popularity.desc&include_adult=false&include_video=false&page=1&with_companies=10342"),e.next=4,E(t);case 4:n=e.sent,a.props.addFilms(n.results),a.setState({loading:!1});case 7:case"end":return e.stop()}},e)})),a.determineFavorites=Object(l.a)(o.a.mark(function e(){var t,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=a.props.user).name){e.next=8;break}return e.next=4,E("http://localhost:3000/api/users/".concat(t.id,"/favorites"));case 4:n=e.sent,JSON.stringify(a.props.films)===JSON.stringify(n.data)?a.buildCards():(a.props.addFilms(n.data),a.setState({showFaves:!0})),e.next=9;break;case 8:a.setState({redirect:!0});case 9:case"end":return e.stop()}},e)})),a.countFavorites=Object(l.a)(o.a.mark(function e(){var t,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.user,e.t0=t.name,!e.t0){e.next=6;break}return e.next=5,E("http://localhost:3000/api/users/".concat(t.id,"/favorites"));case 5:e.t0=e.sent;case 6:return n=e.t0,e.abrupt("return",t.name?"FAVES(".concat(n.data.length,")"):"FAVES(0)");case 8:case"end":return e.stop()}},e)})),a.state={redirect:!1,loading:!1},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.buildCards()}},{key:"render",value:function(){var e=this,t=this.props.user,a=t.name?"WELCOME ".concat(t.name.toUpperCase()):"LOG IN",n=this.countFavorites();return console.log(n),r.a.createElement("div",{className:"App"},r.a.createElement(C,null),r.a.createElement(g.c,{to:"/login",className:"login"},a),r.a.createElement("button",{className:"show-faves",onClick:this.determineFavorites},"FAVES"),this.state.loading?r.a.createElement(F,null):r.a.createElement(b.b,{exact:!0,path:"/ghibli-tracker",component:_}),r.a.createElement(b.b,{exact:!0,path:"/login",component:x}),r.a.createElement(b.b,{path:"/movies/:id",render:function(t){var a=t.match,n=e.props.films.find(function(e){return e.id===a.params.id});if(n)return r.a.createElement(N,n)}}),r.a.createElement(b.b,{exact:!0,path:"/ghibli-tracker",render:function(){return e.state.redirect?r.a.createElement(b.a,{to:"/login"}):e.state.showFaves?r.a.createElement(b.a,{to:"/favorites"}):void 0}}),r.a.createElement(b.b,{exact:!0,path:"/favorites",component:_}))}}]),t}(n.Component),I=Object(v.b)(function(e){return{films:e.films,user:e.user}},function(e){return{addFilms:function(t){return e(function(e){return{type:"ADD_FILMS",films:e}}(t))}}})(U),L=a(15),T=a(23),D=Object(L.b)({films:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_FILMS":return t.films;case"TOGGLE_FAVORITED":return e.map(function(e){return e.id===t.id?Object(T.a)({},e,{favorited:!e.favorited}):e});default:return e}},filter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Show all",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FILTER":return t.filter;default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_USER":return Object(T.a)({},e,{id:t.id,name:t.name});default:return e}}}),A=window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),G=Object(L.c)(D,A);s.a.render(r.a.createElement(v.a,{store:G},r.a.createElement(g.a,null,r.a.createElement(I,null))),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.c18931c3.chunk.js.map